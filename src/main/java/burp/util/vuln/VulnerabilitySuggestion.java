package burp.util.vuln;

import java.util.ArrayList;
import java.util.List;

public class VulnerabilitySuggestion {
    
    private String title;
    private String description;
    private String category;
    private int priority;
    private List<String> testSteps;
    private List<String> testPayloads;
    private String references;
    private String remediation;
    
    public VulnerabilitySuggestion() {
        this.testSteps = new ArrayList<>();
        this.testPayloads = new ArrayList<>();
        this.priority = 3;
    }
    
    public VulnerabilitySuggestion(String title, String description) {
        this();
        this.title = title;
        this.description = description;
    }
    
    public String getTitle() {
        return title;
    }
    
    public void setTitle(String title) {
        this.title = title;
    }
    
    public String getDescription() {
        return description;
    }
    
    public void setDescription(String description) {
        this.description = description;
    }
    
    public String getCategory() {
        return category;
    }
    
    public void setCategory(String category) {
        this.category = category;
    }
    
    public int getPriority() {
        return priority;
    }
    
    public void setPriority(int priority) {
        this.priority = Math.max(1, Math.min(5, priority));
    }
    
    public String getPriorityLevel() {
        switch (priority) {
            case 5: return "紧急";
            case 4: return "高";
            case 3: return "中";
            case 2: return "低";
            case 1: return "建议";
            default: return "未知";
        }
    }
    
    public List<String> getTestSteps() {
        return new ArrayList<>(testSteps);
    }
    
    public void setTestSteps(List<String> testSteps) {
        this.testSteps = testSteps != null ? new ArrayList<>(testSteps) : new ArrayList<>();
    }
    
    public void addTestStep(String step) {
        if (step != null) {
            testSteps.add(step);
        }
    }
    
    public List<String> getTestPayloads() {
        return new ArrayList<>(testPayloads);
    }
    
    public void setTestPayloads(List<String> testPayloads) {
        this.testPayloads = testPayloads != null ? new ArrayList<>(testPayloads) : new ArrayList<>();
    }
    
    public void addTestPayload(String payload) {
        if (payload != null) {
            testPayloads.add(payload);
        }
    }
    
    public String getReferences() {
        return references;
    }
    
    public void setReferences(String references) {
        this.references = references;
    }
    
    public String getRemediation() {
        return remediation;
    }
    
    public void setRemediation(String remediation) {
        this.remediation = remediation;
    }
    
    @Override
    public String toString() {
        return "VulnerabilitySuggestion{" +
                "title='" + title + '\'' +
                ", category='" + category + '\'' +
                ", priority=" + getPriorityLevel() +
                '}';
    }
}
