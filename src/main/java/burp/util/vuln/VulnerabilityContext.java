package burp.util.vuln;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;

public class VulnerabilityContext {
    
    private Map<String, String> headers;
    private Map<String, String> cookies;
    private Map<String, String> parameters;
    private String requestBody;
    private String responseBody;
    private String requestPath;
    private String requestMethod;
    private String contentType;
    private int responseCode;
    private Set<String> technologies;
    private Map<String, Object> customFields;
    
    public VulnerabilityContext() {
        this.headers = new HashMap<>();
        this.cookies = new HashMap<>();
        this.parameters = new HashMap<>();
        this.customFields = new HashMap<>();
    }
    
    public String getHeaderValue(String name) {
        if (name == null) return null;
        for (Map.Entry<String, String> entry : headers.entrySet()) {
            if (entry.getKey().equalsIgnoreCase(name)) {
                return entry.getValue();
            }
        }
        return null;
    }
    
    public String getCookieValue(String name) {
        if (name == null) return null;
        for (Map.Entry<String, String> entry : cookies.entrySet()) {
            if (entry.getKey().equalsIgnoreCase(name)) {
                return entry.getValue();
            }
        }
        return null;
    }
    
    public String getParameterValue(String name) {
        if (name == null) return null;
        for (Map.Entry<String, String> entry : parameters.entrySet()) {
            if (entry.getKey().equalsIgnoreCase(name)) {
                return entry.getValue();
            }
        }
        return null;
    }
    
    public List<String> getParameterNames() {
        return new ArrayList<>(parameters.keySet());
    }
    
    public Object getFieldValue(String fieldName) {
        if (fieldName == null) return null;
        
        switch (fieldName.toLowerCase()) {
            case "requestbody":
            case "request_body":
            case "body":
                return requestBody;
            case "responsebody":
            case "response_body":
            case "response":
                return responseBody;
            case "requestpath":
            case "request_path":
            case "path":
                return requestPath;
            case "requestmethod":
            case "request_method":
            case "method":
                return requestMethod;
            case "contenttype":
            case "content_type":
                return contentType;
            case "responsecode":
            case "response_code":
            case "status":
                return responseCode;
            case "technologies":
            case "tech":
                return technologies;
            default:
                return customFields.get(fieldName);
        }
    }
    
    public void setHeader(String name, String value) {
        headers.put(name, value);
    }
    
    public void setCookie(String name, String value) {
        cookies.put(name, value);
    }
    
    public void setParameter(String name, String value) {
        parameters.put(name, value);
    }
    
    public void setCustomField(String name, Object value) {
        customFields.put(name, value);
    }
    
    public Map<String, String> getHeaders() {
        return new HashMap<>(headers);
    }
    
    public void setHeaders(Map<String, String> headers) {
        this.headers = headers != null ? new HashMap<>(headers) : new HashMap<>();
    }
    
    public Map<String, String> getCookies() {
        return new HashMap<>(cookies);
    }
    
    public void setCookies(Map<String, String> cookies) {
        this.cookies = cookies != null ? new HashMap<>(cookies) : new HashMap<>();
    }
    
    public Map<String, String> getParameters() {
        return new HashMap<>(parameters);
    }
    
    public void setParameters(Map<String, String> parameters) {
        this.parameters = parameters != null ? new HashMap<>(parameters) : new HashMap<>();
    }
    
    public String getRequestBody() {
        return requestBody;
    }
    
    public void setRequestBody(String requestBody) {
        this.requestBody = requestBody;
    }
    
    public String getResponseBody() {
        return responseBody;
    }
    
    public void setResponseBody(String responseBody) {
        this.responseBody = responseBody;
    }
    
    public String getRequestPath() {
        return requestPath;
    }
    
    public void setRequestPath(String requestPath) {
        this.requestPath = requestPath;
    }
    
    public String getRequestMethod() {
        return requestMethod;
    }
    
    public void setRequestMethod(String requestMethod) {
        this.requestMethod = requestMethod;
    }
    
    public String getContentType() {
        return contentType;
    }
    
    public void setContentType(String contentType) {
        this.contentType = contentType;
    }
    
    public int getResponseCode() {
        return responseCode;
    }
    
    public void setResponseCode(int responseCode) {
        this.responseCode = responseCode;
    }
    
    public Set<String> getTechnologies() {
        return technologies;
    }
    
    public void setTechnologies(Set<String> technologies) {
        this.technologies = technologies;
    }
}
